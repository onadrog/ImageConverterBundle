!function(){const e=document.querySelector("input[data-name='image_converter']"),t=(document.querySelector("input[data-name='alt']"),new FileReader),a=(new FormData,document.createElement("canvas")),n=(a.getContext("2d"),new Image),d=document.createElement("canvas"),i=d.getContext("2d"),o=new Image,r=document.createElement("input");e.addEventListener("change",(l=>{const m=document.querySelector("form"),c=document.getElementById(m.name),s=l.target,g=s.files[0],p=g.name,u=parseInt(e.dataset.qual,10)/100;n.height=200,t.onload=e=>{n.src=e.target.result},n.onload=()=>{a.width=n.width,a.height=n.height},t.readAsDataURL(g),s.parentElement.append(n);const h=URL.createObjectURL(g);o.src=h,o.onload=()=>{URL.revokeObjectURL(h),d.width=o.width,d.height=o.height,i.drawImage(o,0,0),r.type="file",r.name=`${m.name}[${e.dataset.prop}][original_file]`,r.style.display="none";let t=new DataTransfer;t.items.add(g),r.files=t.files,c.append(r),d.toBlob((t=>{const a=new File([t],p,{type:"image/webp",lastModified:(new Date).getTime()});let n=new DataTransfer;n.items.add(a),e.files=n.files}),"image/webp",u)}}))}();